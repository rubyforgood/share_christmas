<h1>Administrator List</h1>

<p>
Administrators for your organization are allowed to do the same things you can:
import member lists, add or remove members, manually match givers and recipients, etc.
</p>

<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Member Since</th>
      <th>Last Signed On</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% @memberships.each do |m| %>
      <tr>
        <td><%= m.name %></td>
        <td><%= m.email %></td>
        <td><%= nice_date(m.user_created_at) %></td>
        <td><%= nice_datetime(m.last_sign_in_at) %></td>
        <td>
          <%= form_for m do |f| %>
            <%= f.hidden_field :org_admin, value: false %> 
            <% if m.id == current_user.id %>
              Can't remove yourself!
            <% else %>
              <%= f.submit("Remove") %>
            <% end %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<p>Create a new organization administrator by filling out the form below.  The user will receive
an email from which they can create their own password.</p>

<%# TODO: This probably can be shared as a general new user form, but not quite sure where. %>
<%#       Also this might seem a little backwards - shouldn't the user be the outer form? %>
<%#       But I couldn't get it to work like that for memberships %>

<%= form_for @membership do |m_form| %>
  <%= m_form.hidden_field :organization_id, value: @org.id %>
  <%= m_form.hidden_field :org_admin, value: true %> 
  <%= m_form.hidden_field :send_email, value: true %>

  <%= m_form.fields_for @user do |f| %>
    <%= label_tag :first_name %>
    <br>
    <%= f.text_field :first_name %>
    <br>
    <%= label_tag :last_name %>
    <br>
    <%= f.text_field :last_name %>
    <br>
    <%= label_tag :email %>
    <br>
    <%= f.text_field :email %>
    <br>
    <%= f.submit "Create Administrator"%>
  <% end %>
<% end %>


